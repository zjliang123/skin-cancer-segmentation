# 皮肤病变图像分割项目（基于 UNet 和 PyTorch）

本项目基于 PyTorch，实现了皮肤病理图像的多类别分割。使用 UNet 模型对灰度图进行训练，支持多类别掩码映射和 TensorBoard 可视化训练过程。

---

## 功能

- 使用 UNet 模型进行皮肤病变图像分割  
- 支持多类别掩码映射，将不同颜色的掩码转换为类别标签  
- 训练过程可在 TensorBoard 中可视化  
- 支持 GPU 加速训练，提高训练速度  

---

## 数据集说明

项目假设数据集目录结构如下：

- 图像会统一调整为 256x256 像素  
- 掩码颜色会映射为对应类别索引，用于多分类训练  

---

## 环境依赖

建议使用虚拟环境，并安装以下依赖：

- Python 3.8 或以上  
- PyTorch  
- Torchvision  
- OpenCV  
- NumPy  
- tqdm  
- TensorBoard  

---

## 数据加载

项目使用自定义 `SkinDataset` 类加载图像和掩码：

- 图像会被转换为灰度图，并增加通道维度  
- 掩码颜色会映射为类别索引  
- 支持批量加载和数据打乱  

---

## 模型说明

- 使用自定义 UNet2D 模型  
- 输入通道为 1（灰度图）  
- 输出通道为 10（对应 10 个类别）  
- 可处理多类别分割任务，并支持不同分辨率图像  

---

## 训练说明

训练设置：

- 损失函数：交叉熵损失（CrossEntropyLoss）  
- 优化器：Adam，学习率 0.0001，增加权重衰减防止过拟合  
- 训练轮数：30 Epoch（可根据需要调整）  

训练过程：

- 每个 Epoch 对所有批次进行前向传播、计算损失、反向传播和优化  
- 每个 Epoch 的损失会记录在 TensorBoard 中  
- 可通过 TensorBoard 监控训练趋势和收敛情况  

---

